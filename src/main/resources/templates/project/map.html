<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic.html}">
<head>
  <meta charset="UTF-8">
  <title>Title</title>

  <style>



  </style>
  <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=hmecoefot7&submodules=geocoder"></script>
<!--  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>-->
</head>

<div class="container-lg content" layout:fragment="content">
  <h1>네이버지도</h1>
  <h3>[[${campingLocation}]]</h3>

  <div class="search">
    <input id="address" type="text">
    <input type="submit" id="submit">
  </div>
  <div id="map" style="width:100%;height:400px;"></div>
  <script th:inline="javascript" layout:fragment="script">


    var mapOptions = {
      center: new naver.maps.LatLng(37.3595704, 127.105399),
      zoom: 15,
      mapTypeControl: true
    };

    var map = new naver.maps.Map('map', mapOptions);

    var infoWindow = new naver.maps.InfoWindow({
      anchorSkew: true
    });

    map.setCursor('pointer');


    function searchAddressToCoordinate(address) {
      naver.maps.Service.geocode({
        query: address
      }, function(status, response) {
        if (status === naver.maps.Service.Status.ERROR) {
          return alert('Something Wrong!');
        }

        if (response.v2.meta.totalCount === 0) {
          return alert('totalCount' + response.v2.meta.totalCount);
        }

        var htmlAddresses = [],
                item = response.v2.addresses[0],
                point = new naver.maps.Point(item.x, item.y);

        if (item.roadAddress) {
          htmlAddresses.push('[도로명 주소] ' + item.roadAddress);
        }

        if (item.jibunAddress) {
          htmlAddresses.push('[지번 주소] ' + item.jibunAddress);
        }

        if (item.englishAddress) {
          htmlAddresses.push('[영문명 주소] ' + item.englishAddress);
        }

        infoWindow.setContent([
          '<div style="padding:10px;min-width:200px;line-height:150%;">',
          '<h4 style="margin-top:5px;">검색 주소 : '+ address +'</h4><br />',
          htmlAddresses.join('<br />'),
          '</div>'
        ].join('\n'));

        map.setCenter(point);
        infoWindow.open(map, point);
      });
    }
    var address = [[${campingLocation}]];
    console.log(address);

    function initGeocoder() {
      searchAddressToCoordinate(address);
    }

    naver.maps.onJSContentLoaded = initGeocoder;

  </script>
</div> <!--/ container content  /-->



</html>